{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
    <h2 class="fw-bold text-secondary mb-0">–°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏</h2>
    
    <div class="d-flex flex-wrap gap-2 flex-grow-1 justify-content-lg-end align-items-center">
        <!-- –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫ -->
        <select id="logLines" class="form-select shadow-sm" style="width: auto; border-radius: 8px;" onchange="fetchLogs()">
            <option value="100">100 —Å—Ç—Ä–æ–∫</option>
            <option value="300" selected>300 —Å—Ç—Ä–æ–∫</option>
            <option value="500">500 —Å—Ç—Ä–æ–∫</option>
            <option value="1000">1000 —Å—Ç—Ä–æ–∫</option>
        </select>

        <!-- –§–∏–ª—å—Ç—Ä —É—Ä–æ–≤–Ω—è –ª–æ–≥–æ–≤ -->
        <select id="logPriority" class="form-select shadow-sm" style="width: auto; border-radius: 8px;" onchange="fetchLogs()">
            <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
            <option value="error">üî¥ –û—à–∏–±–∫–∏</option>
            <option value="warning">üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</option>
            <option value="info">üîµ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</option>
        </select>

        <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –º–µ–Ω—é —Å –≥–∞–ª–æ—á–∫–∞–º–∏ (–ò—Å—Ç–æ—á–Ω–∏–∫–∏) -->
        <div class="dropdown">
            <button class="btn bg-white border shadow-sm dropdown-toggle d-flex align-items-center gap-1" type="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" style="border-radius: 8px;">
                <span class="material-symbols-outlined fs-6 text-secondary">filter_list</span> –ò—Å—Ç–æ—á–Ω–∏–∫–∏
            </button>
            <ul class="dropdown-menu p-2 shadow" id="sourceFilterMenu" style="max-height: 350px; overflow-y: auto; width: 260px;">
                <li><span class="text-muted small px-2">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ª–æ–≥–∏...</span></li>
            </ul>
        </div>
        
        <!-- –ü–æ–∏—Å–∫ -->
        <input type="text" id="logSearch" class="form-control shadow-sm" placeholder="–ü–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞..." style="max-width: 200px; border-radius: 8px;">
        
        <button class="btn btn-primary shadow-sm d-flex align-items-center gap-1" onclick="fetchLogs()" style="border-radius: 8px;">
            <span class="material-symbols-outlined fs-6">refresh</span> –û–±–Ω–æ–≤–∏—Ç—å
        </button>
        
        <button id="autoRefreshBtn" class="btn btn-secondary shadow-sm" onclick="toggleAutoRefresh()" style="border-radius: 8px;">
            –ê–≤—Ç–æ: –í–´–ö–õ
        </button>
    </div>
</div>

<!-- –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –¥–æ –∫–æ–Ω—Ü–∞ —ç–∫—Ä–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é calc() -->
<div class="card border-0 shadow-sm" style="height: calc(100vh - 130px); overflow: hidden;">
    <div class="card-body p-0 h-100">
        <div class="table-responsive h-100">
            <table class="table align-middle mb-0" style="font-size: 0.9rem;">
                <!-- –ü—Ä–∏–ª–∏–ø–∞—é—â–∞—è —à–∞–ø–∫–∞ -->
                <thead class="table-dark position-sticky top-0" style="z-index: 10;">
                    <tr>
                        <th class="ps-3" style="width: 120px;">–í—Ä–µ–º—è</th>
                        <th style="width: 100px;">–£—Ä–æ–≤–µ–Ω—å</th>
                        <th style="width: 180px;">–ò—Å—Ç–æ—á–Ω–∏–∫</th>
                        <th class="pe-3">–°–æ–æ–±—â–µ–Ω–∏–µ</th>
                    </tr>
                </thead>
                <tbody id="logsTableBody">
                    <tr><td colspan="4" class="text-center py-5 text-muted">–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/logs.js"></script>
{% endblock %}